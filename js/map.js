(function (window, document, undefined) {

    //WMTS設定
    var streets = L.tileLayer('https://mt{s}.google.com/vt/x={x}&y={y}&z={z}&hl=zh-TW', {
            id : 'streets',
            subdomains : "012",
            attribution : 'Map data: &copy; Google'
        });

    var satellite = L.tileLayer('https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            id : 'topography',
            subdomains : "012",
            attribution : 'Map data: &copy; Google'
        });

    //群組
    var baseMaps = {
        "Google地圖" : streets,
        "Google衛星影像" : satellite
    };

    var geoData = {
        PotentialDanger: {},
        SankuaicuoRiverWeir: {},
        AutoSite: {},
        River: {},
        Factory: {},
        Resin: {},
        metal: {
            "type": "FeatureCollection",
            "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
            "features": [
                { "type": "Feature", "properties": { "Name": "詹厝園圳2、3給匯流處" }, "geometry": { "type": "Point", "coordinates": [120.67223048529503, 24.088778024497461] } },
                { "type": "Feature", "properties": { "Name": "新圳中游" }, "geometry": { "type": "Point", "coordinates": [120.47728963929933, 24.092019137960484] } }
            ]
        },
        Irrigation: {
            "type": "FeatureCollection",
            "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
            "features": [
                { "type": "Feature", "properties": { "GRP_CNS": "新圳", "Shape_area": 1394568.72162 }, "geometry": { "type": "Polygon", "coordinates": [[[120.47889140688338, 24.099726682857771], [120.47978581323903, 24.099396704137501], [120.48001712678789, 24.09929010677714], [120.48012603784247, 24.099220717538401], [120.48025910040649, 24.09913376094023], [120.48064193994104, 24.098812516133037], [120.48071373295339, 24.098761647474017], [120.48075809369156, 24.098745773120701], [120.48081803111538, 24.098736413868618], [120.48085969043397, 24.098738946293167], [120.48090392442452, 24.098748659353699], [120.48166849146385, 24.099023793432686], [120.48182206891408, 24.09904343980714], [120.48220640416928, 24.099060639931807], [120.48222489159612, 24.099056604195138], [120.48182713351893, 24.097741165256444], [120.48217072497316, 24.097413169505977], [120.48238616558947, 24.09716901326712], [120.48258196213499, 24.096913814300947], [120.48277517424016, 24.096632343939071], [120.48307517166961, 24.096124651626756], [120.48318729918562, 24.095875660877205], [120.48335147541991, 24.094963749092756], [120.48348331734378, 24.091336997154784], [120.48216774722881, 24.091374758782518], [120.48035891555735, 24.091788424612268], [120.47929327351298, 24.092001596040394], [120.47882068606377, 24.092080119219766], [120.47846336877683, 24.092113721949598], [120.47802072306159, 24.092132471128178], [120.47757752137082, 24.092125060382923], [120.47728092247077, 24.092118921642964], [120.47727050414207, 24.09104549619957], [120.4772555130268, 24.089584215660754], [120.47382197859073, 24.08951522580379], [120.47383364333359, 24.088943124165134], [120.47226195058184, 24.089170033958286], [120.4703063260137, 24.089387585439148], [120.46835001762524, 24.089381035995302], [120.46904640116443, 24.09124983529999], [120.4698430165153, 24.093489171910203], [120.46929936135416, 24.093718415371086], [120.46908643899418, 24.093794719627141], [120.46885117795814, 24.093860672542295], [120.46989796240459, 24.094980124360291], [120.47001278761127, 24.095099084087138], [120.47019661147476, 24.09525143540348], [120.47049122615191, 24.095424156434483], [120.470908837186, 24.095610859091352], [120.47106903460175, 24.095720476335341], [120.47120326819102, 24.095828762992397], [120.4713691339126, 24.096032251820507], [120.47149689993367, 24.096303111108508], [120.47095338599364, 24.09691199820633], [120.47120586330719, 24.097144406793682], [120.47230933268794, 24.098285151349714], [120.47288215706554, 24.099094739577598], [120.47323093036798, 24.09948188082247], [120.4740364890348, 24.100499530225999], [120.4752223669181, 24.101811509150306], [120.47550186837688, 24.102005437980178], [120.47609782889056, 24.102262500961771], [120.47610651166943, 24.102262198449012], [120.47658448806031, 24.102282916562466], [120.47670669841366, 24.102299432294924], [120.47732731730397, 24.102442894543746], [120.4778567356294, 24.101508946022559], [120.47849419056401, 24.100567818383848], [120.47867388389534, 24.100374721428167], [120.47869020021342, 24.100342875075349], [120.47869776648203, 24.10029882028137], [120.47862724147433, 24.099983544306788], [120.47862538595199, 24.099928974464735], [120.47863558769924, 24.099881667310349], [120.47866031108306, 24.099837873289392], [120.47868819571796, 24.099814024734755], [120.47872523877737, 24.099788718491109], [120.47877261351547, 24.099770509214185], [120.47889140688338, 24.099726682857771]]] } },
                { "type": "Feature", "properties": { "GRP_CNS": "小新圳", "Shape_area": 1273944.75019 }, "geometry": { "type": "Polygon", "coordinates": [[[120.48936699590159, 24.087616442687953], [120.49037625671134, 24.087287383017284], [120.48981850154101, 24.085845755506664], [120.48968505208781, 24.085494267949663], [120.48953055815306, 24.085086949066081], [120.48904550484528, 24.083700086096556], [120.48854269052603, 24.082328255360828], [120.48838305599817, 24.081971312955893], [120.48835912981613, 24.081947546510527], [120.48831469399579, 24.081935963219891], [120.48827998305633, 24.081939931009678], [120.48799891702494, 24.082047740298634], [120.4884165911225, 24.081249784772542], [120.48814640854005, 24.08104978784127], [120.48728113065179, 24.08192192491234], [120.48640681931761, 24.082789170570624], [120.48567686094813, 24.08351372715244], [120.48530075834054, 24.083871317931486], [120.48491823283997, 24.084153976873747], [120.48460853544329, 24.084345685028477], [120.48441308667223, 24.084468938892421], [120.48413325661333, 24.084612986623743], [120.48377311350386, 24.084747646829932], [120.48359430435809, 24.084801630250734], [120.48348430936797, 24.084826481934932], [120.48315192830525, 24.084884857959988], [120.48278259451953, 24.084931544546063], [120.48233935771958, 24.084991811062853], [120.48207584871504, 24.085046699619085], [120.48190311424777, 24.085099291252678], [120.48176239434967, 24.085159538718234], [120.48145907666728, 24.085316075988384], [120.48110743547171, 24.085503931796204], [120.48105176717915, 24.085612848481428], [120.4807277013482, 24.086246899510897], [120.48047449433777, 24.086756834587273], [120.48004783633316, 24.08776710647739], [120.47987251076596, 24.088199364921643], [120.47975100135373, 24.088431702381445], [120.4795516790102, 24.088746726377504], [120.47945277903688, 24.088870193916062], [120.47922487161719, 24.089129531721792], [120.47836516378106, 24.089967383387588], [120.47804906331307, 24.090270581260395], [120.47727050414207, 24.09104549619957], [120.47728092247077, 24.092118921642964], [120.47757752137082, 24.092125060382923], [120.47802072306159, 24.092132471128178], [120.47846336877683, 24.092113721949598], [120.47882068606377, 24.092080119219766], [120.47929327351298, 24.092001596040394], [120.48035891555735, 24.091788424612268], [120.48216774722881, 24.091374758782518], [120.48348331734378, 24.091336997154784], [120.48335147541991, 24.094963749092756], [120.48318729918562, 24.095875660877205], [120.48307517166961, 24.096124651626756], [120.48277517424016, 24.096632343939071], [120.48258196213499, 24.096913814300947], [120.48238616558947, 24.09716901326712], [120.48217072497316, 24.097413169505977], [120.48182713351893, 24.097741165256444], [120.48222489159612, 24.099056604195138], [120.48291395129053, 24.098906193079035], [120.48306771376747, 24.098908673388138], [120.48338368789589, 24.098937189524676], [120.48423886703264, 24.098946243437421], [120.48435418682794, 24.098929901358158], [120.48438299165737, 24.098917408185279], [120.48452244876296, 24.098856925002416], [120.48484362337335, 24.098640754855172], [120.48523626139648, 24.098337533819642], [120.48603351821706, 24.097717984157146], [120.48609345648894, 24.097650265176043], [120.48614390045091, 24.097569369517394], [120.48617040676702, 24.097505920901195], [120.48626986062615, 24.097105309043862], [120.48630140319041, 24.09697614821189], [120.48633211809459, 24.096764203792354], [120.48641184403294, 24.096214064800506], [120.48647244513869, 24.095979835483003], [120.48666997622266, 24.095522588220824], [120.48670385173074, 24.095406580747337], [120.48670425327806, 24.095305797912904], [120.48667605022507, 24.095196155268411], [120.486586160716, 24.094994285043626], [120.48655787051175, 24.094906551492091], [120.48656295808789, 24.094827693800855], [120.48660147576872, 24.094744566495677], [120.48664217098376, 24.094714029979144], [120.4867617297627, 24.094657466033567], [120.48691458860434, 24.094629496442387], [120.48701956478183, 24.094631455021531], [120.48707683585053, 24.094640996040383], [120.48762354754187, 24.09475238181286], [120.48765632820121, 24.094759060435301], [120.48777969315643, 24.094767776192242], [120.48783875753918, 24.094762686562852], [120.48791362274409, 24.094749517215867], [120.48797969798403, 24.094728605629317], [120.48804736914222, 24.094692202499935], [120.48831355467121, 24.094519805673968], [120.48890036090361, 24.094086378407148], [120.48920481865838, 24.093847015354267], [120.49037789978388, 24.092916725625521], [120.48982497854909, 24.091519244434821], [120.48942217592685, 24.090511810630588], [120.48908663981963, 24.089673766764054], [120.48908360968882, 24.089646688808788], [120.48909425316738, 24.089632146678696], [120.4891172294743, 24.089622504384572], [120.48914723680751, 24.089622361756565], [120.48935697695741, 24.089621460574861], [120.48970665125688, 24.089503261517208], [120.49005818378811, 24.089385067846685], [120.48970879171627, 24.088493769724497], [120.48936699590159, 24.087616442687953]]] } },
                { "type": "Feature", "properties": { "GRP_CNS": "詹厝園圳小組", "Shape_area": 1787602.6152 }, "geometry": { "type": "Polygon", "coordinates": [[[120.68630466994557, 24.092468905218652], [120.68413476019217, 24.090679737774579], [120.68228511280374, 24.08922849518099], [120.68023930014365, 24.087921760723862], [120.67802446374566, 24.086578520292981], [120.67723439340075, 24.086136707670885], [120.67720052113427, 24.086120832952652], [120.67533707579115, 24.085180062836319], [120.67387246001351, 24.084601341528188], [120.6719156517109, 24.084055414941169], [120.67058449310908, 24.083709394568238], [120.66777152944589, 24.083211778286017], [120.66694216642458, 24.083115966817608], [120.66600357914238, 24.083030659131481], [120.66566734898521, 24.083357912076199], [120.66511336965431, 24.083810392756934], [120.66483001189445, 24.084051338504828], [120.66473511263138, 24.084136919489058], [120.6643455081327, 24.084458815368304], [120.66419379424515, 24.084584909802874], [120.663751051771, 24.084936125899802], [120.66343610077585, 24.085188196841457], [120.66316439935545, 24.085374981598111], [120.66312514334446, 24.085401986857388], [120.66267529964074, 24.085581605268878], [120.66234966720282, 24.08557411370148], [120.662082123254, 24.085566749810418], [120.66187512834438, 24.085579838136308], [120.66157088894565, 24.08561302980053], [120.66142439781287, 24.085633024332644], [120.66108731889702, 24.085659278193781], [120.66095859143144, 24.085649962577602], [120.6608334691544, 24.085719671777948], [120.66069536033112, 24.085791609402925], [120.66067984717581, 24.08579834791276], [120.66055952229893, 24.085863551941568], [120.66049624011745, 24.085895017870964], [120.66042304192678, 24.085933234685584], [120.66041377506973, 24.085939987038302], [120.66030846373717, 24.085942011388987], [120.66022785936403, 24.085989241930683], [120.66008024605948, 24.086065673461995], [120.65946216784707, 24.086416397691188], [120.65894958723509, 24.086724549172995], [120.6589132679506, 24.086744786954995], [120.658168384711, 24.087153921083722], [120.65814160869303, 24.087063556714241], [120.6576070282061, 24.087130089065344], [120.65695681703649, 24.087539519459185], [120.65607259388665, 24.08947881869247], [120.656281520063, 24.089747945456292], [120.65732758792475, 24.090343958677089], [120.65780702065582, 24.090365350270318], [120.65836982262506, 24.090461429744934], [120.65929401008503, 24.090917184024299], [120.66005539870363, 24.091885051364653], [120.66016108167018, 24.092051627941039], [120.66036669094609, 24.092137241640959], [120.66061472218774, 24.092103657805563], [120.66067026556586, 24.092146946862425], [120.66108573824721, 24.092088989720416], [120.66114890870283, 24.092471390546429], [120.66135833531997, 24.092710169244267], [120.66229834350494, 24.092557374954151], [120.6632716150431, 24.092404558733438], [120.66509873731559, 24.092124111619619], [120.6670833763509, 24.091135271454654], [120.66783752153117, 24.089838416053379], [120.66842797232461, 24.089596415629217], [120.6688921446375, 24.089368228031816], [120.66926137792527, 24.089208735013599], [120.66959004393173, 24.089144335664823], [120.66997742309798, 24.089153481070529], [120.67059295152235, 24.089381563879243], [120.67193609359032, 24.089887360518489], [120.67280795947038, 24.090517300122002], [120.67385101630468, 24.091342026810182], [120.67515176572557, 24.092456721628842], [120.67521092628519, 24.092579842709309], [120.67716804425319, 24.09425706983588], [120.67727195704511, 24.094362494037718], [120.67765998062964, 24.093990895321685], [120.67793497310988, 24.093558009932899], [120.67793968127475, 24.093427077699904], [120.67800144906082, 24.093190247270407], [120.67800716772226, 24.093174456106322], [120.67805513489668, 24.093005235612747], [120.6782848696503, 24.092077924878517], [120.67829521624887, 24.091865820462147], [120.67829448431817, 24.091671662990557], [120.67832948193394, 24.091692055426346], [120.67836263726475, 24.091703412798143], [120.67951424496474, 24.091309662665779], [120.67985427740702, 24.091405647581858], [120.68273644482157, 24.091601476284133], [120.68630466994557, 24.092468905218652]]] } },
                { "type": "Feature", "properties": { "GRP_CNS": "頭庄抽水機", "Shape_area": 1739574.7387000001 }, "geometry": { "type": "Polygon", "coordinates": [[[120.47095338599364, 24.09691199820633], [120.47149689993367, 24.096303111108508], [120.4713691339126, 24.096032251820507], [120.47120326819102, 24.095828762992397], [120.47106903460175, 24.095720476335341], [120.470908837186, 24.095610859091352], [120.47049122615191, 24.095424156434483], [120.47019661147476, 24.09525143540348], [120.47001278761127, 24.095099084087138], [120.46989796240459, 24.094980124360291], [120.46885117795814, 24.093860672542295], [120.46691104170462, 24.094314574433842], [120.46409097032759, 24.094965668714806], [120.46384945920552, 24.095057333294925], [120.46365190420283, 24.095159540706867], [120.46008266259942, 24.097244643129937], [120.45970195162725, 24.097467041425894], [120.45929456112152, 24.097693923987567], [120.45921658267214, 24.097762076787383], [120.45904788514844, 24.097932069337272], [120.45879079470478, 24.098294333301681], [120.45874436472536, 24.098372299408265], [120.45796705426964, 24.099789352758624], [120.45738717915829, 24.100873664723682], [120.457243313132, 24.101146449371836], [120.4571648515473, 24.101265928455199], [120.4572176428771, 24.101282675463125], [120.45724353034971, 24.1012837335143], [120.45767239973532, 24.101159574046164], [120.45938743164179, 24.100660084550171], [120.46062026529232, 24.100287688840844], [120.46173540189662, 24.100017129677227], [120.46340217952809, 24.099624710484004], [120.46397734415035, 24.099486792240988], [120.46424746756814, 24.100795605542899], [120.46439174026833, 24.101350474802352], [120.46460015182298, 24.101991682716825], [120.46508378128861, 24.103334166103313], [120.46629465683527, 24.10198684534787], [120.46670266610629, 24.101545857874765], [120.46704550608821, 24.102823762999684], [120.46735027082124, 24.103846713540378], [120.46720556558751, 24.103901468723677], [120.46614714324068, 24.104415354800736], [120.4657223661294, 24.10458966066906], [120.46598802178097, 24.10456112597933], [120.46685056139253, 24.104530806102431], [120.46694130563841, 24.104539455676814], [120.46700020850483, 24.1045646593351], [120.46715389521231, 24.104719356067623], [120.46729845258608, 24.104886519938344], [120.46807322200236, 24.105226704462417], [120.46826808834849, 24.105302379059673], [120.46843582401677, 24.105352960823009], [120.46863995793126, 24.105382835901821], [120.46863378607819, 24.105778631699991], [120.46864493569579, 24.105826584781511], [120.46869241478966, 24.105870498098739], [120.46878757933477, 24.105908327153905], [120.46889192413437, 24.105921189830692], [120.46972038306257, 24.10591156668837], [120.4710796855807, 24.105364711652992], [120.47198084789616, 24.10502453143646], [120.47211951673067, 24.104960662088601], [120.47218025416279, 24.10492471986295], [120.47225290131489, 24.104870373894435], [120.47234134241377, 24.104781581856276], [120.47242983747137, 24.10467958926305], [120.47267986959746, 24.104336151675085], [120.47308895646277, 24.103790896052452], [120.47354110357843, 24.103177555713472], [120.47363476498091, 24.103059588550462], [120.47429951672935, 24.104444754556077], [120.4750119941709, 24.106104920458758], [120.47526708995227, 24.106673227525881], [120.47539949428521, 24.10706005684084], [120.47550093674214, 24.107460063524531], [120.47554364075881, 24.107734688663729], [120.47557358900998, 24.10819107108539], [120.47633462470068, 24.109191871279943], [120.47521762478178, 24.109251608479614], [120.47520515755184, 24.109124426466511], [120.47452192543493, 24.109161167704727], [120.47445165242355, 24.108148423679435], [120.47341265436464, 24.108188550912466], [120.47345329006028, 24.108836308102585], [120.47242761578052, 24.108889486432357], [120.47255935122459, 24.110527143209513], [120.47151583163794, 24.110543679075068], [120.47150986302982, 24.110680152699011], [120.47154215504838, 24.110717489927183], [120.47285088409187, 24.111090307581581], [120.47285947404157, 24.11118176860808], [120.4729090881922, 24.111228570115426], [120.47308912418821, 24.111292278912767], [120.47355400434644, 24.111367025865164], [120.47387043611037, 24.111448575782884], [120.47442045663917, 24.111652532051561], [120.47463715595477, 24.111763909259238], [120.47478335215536, 24.111821098928395], [120.47500177694486, 24.111834922941792], [120.47522258130344, 24.111807741515911], [120.47529097701188, 24.111801082615418], [120.47543744351671, 24.111804334001025], [120.47549805398343, 24.111811481003272], [120.47554337585657, 24.111830902159902], [120.47560262512691, 24.111867452529189], [120.47563676432149, 24.111895310079376], [120.47568566307453, 24.111943696478381], [120.47574639686106, 24.112052467369061], [120.4758579136103, 24.112339327266589], [120.4759160750173, 24.112449863500803], [120.47601404437466, 24.112592305446917], [120.47653040737403, 24.113316167872256], [120.4766326585066, 24.113316518157987], [120.47660226584978, 24.112870807162331], [120.47759963055695, 24.112832959730966], [120.47759138939172, 24.112501509584998], [120.47863389344845, 24.112469036683972], [120.47862769085238, 24.112097745853475], [120.47825262105823, 24.111595903243607], [120.47934563546815, 24.111187012618242], [120.47924135013089, 24.111017311036488], [120.47927944612738, 24.110546910426084], [120.47860224054101, 24.109044639187271], [120.47860442061125, 24.108506555114392], [120.47854979089828, 24.108081022977029], [120.47846758018044, 24.107672752604671], [120.47996149955773, 24.107105456439992], [120.47820199836525, 24.103139791195751], [120.47820189224377, 24.103126411356939], [120.47820496861068, 24.10311705676796], [120.4782118174663, 24.103107645533282], [120.47822212490598, 24.103099664593795], [120.47824247544942, 24.103092619956527], [120.47855074846279, 24.102977409259704], [120.47856140792517, 24.102969450264947], [120.47856779014708, 24.102960612582081], [120.47856928702011, 24.102948764147325], [120.47856789681876, 24.102934266626004], [120.47855853216473, 24.102911532544383], [120.47854470658405, 24.102892231496288], [120.47845283133837, 24.102810006859794], [120.47838968255816, 24.102766588414731], [120.47830572280792, 24.102722734130715], [120.47819994131117, 24.102684419663102], [120.47732731730397, 24.102442894543746], [120.47670669841366, 24.102299432294924], [120.47658448806031, 24.102282916562466], [120.47610651166943, 24.102262198449012], [120.47609782889056, 24.102262500961771], [120.47550186837688, 24.102005437980178], [120.4752223669181, 24.101811509150306], [120.4740364890348, 24.100499530225999], [120.47323093036798, 24.09948188082247], [120.47288215706554, 24.099094739577598], [120.47230933268794, 24.098285151349714], [120.47120586330719, 24.097144406793682], [120.47095338599364, 24.09691199820633]]] } }
            ]
        }
        ,
        TaichungGrid: {
            "type": "FeatureCollection",
            "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
            "features": [
                { "type": "Feature", "properties": { "name": "三給", "id": 1, "pid": 1 }, "geometry": { "type": "LineString", "coordinates": [[120.67533526803595, 24.091991001641496], [120.67523083173171, 24.091944620503856], [120.67511510501619, 24.091887932423912], [120.67495139405277, 24.091813207189318], [120.67485542555696, 24.091766825987303]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 2, "pid": 2 }, "geometry": { "type": "LineString", "coordinates": [[120.67485471990632, 24.091766825987293], [120.67475875141054, 24.091725598238078], [120.67472346887529, 24.091712714563723], [120.67464443599641, 24.091661179853375], [120.67454987880201, 24.091603203279444], [120.67446802332032, 24.091551668525042], [120.67440874866115, 24.091513017445642], [120.67434241749491, 24.091491115162142]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 3, "pid": 3 }, "geometry": { "type": "LineString", "coordinates": [[120.67434100619352, 24.091491115162142], [120.67420410995688, 24.09143442688158], [120.67410814146108, 24.091394487396119], [120.6740658024188, 24.09137902694679]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 5, "pid": 4 }, "geometry": { "type": "LineString", "coordinates": [[120.67406368546669, 24.091380315317636], [120.67396207176526, 24.091323626988043], [120.67390703101033, 24.091259208401247], [120.67371227141591, 24.091134236250529], [120.673501987506, 24.091059510576393], [120.67347940668347, 24.09104662683508]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 5, "pid": 5 }, "geometry": { "type": "LineString", "coordinates": [[120.67347799538204, 24.091047915209273], [120.67341448681867, 24.091011840727042], [120.67321549332003, 24.090825026281578], [120.67317315427776, 24.090786374983001], [120.67305883886367, 24.090680728040731], [120.67299391899886, 24.090615020752207]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 6, "pid": 6 }, "geometry": { "type": "LineString", "coordinates": [[120.67299039074533, 24.090619530077014], [120.67285208320729, 24.090485538643868], [120.67280692156218, 24.090439156961299], [120.67266579142132, 24.090310318866059], [120.67247808833392, 24.090039758444437], [120.6723284903846, 24.089834905173579]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 7, "pid": 7 }, "geometry": { "type": "LineString", "coordinates": [[120.67232707908319, 24.089836193560114], [120.67226639312261, 24.089752448418889], [120.67226921572544, 24.08967643355102], [120.67228615134235, 24.089640358682693], [120.67231296606911, 24.089560478580982], [120.67235107120716, 24.089461272578877], [120.67240187805787, 24.089320837977063], [120.67241881367475, 24.089280897832847]] } },
                { "type": "Feature", "properties": { "name": "三給", "id": 8, "pid": 8 }, "geometry": { "type": "LineString", "coordinates": [[120.67241881367475, 24.089280897832847], [120.67245268490856, 24.089179759024873], [120.67249079004658, 24.089056717437487], [120.67249996350574, 24.089027084367377], [120.67245550751137, 24.088956866847809], [120.67239976110571, 24.088873121131957]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 1, "pid": 9 }, "geometry": { "type": "LineString", "coordinates": [[120.67777609016248, 24.092861085399846], [120.6776403168796, 24.092747468733052], [120.67752232343142, 24.09269730030266]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 2, "pid": 10 }, "geometry": { "type": "LineString", "coordinates": [[120.67752232343142, 24.09269730030266], [120.6774916128079, 24.09268106933569], [120.67724916051709, 24.092623523163478], [120.6771392488119, 24.092620572077028], [120.67690366600263, 24.092521710641634], [120.67676021506391, 24.092431702402752]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 3, "pid": 11 }, "geometry": { "type": "LineString", "coordinates": [[120.67675617419246, 24.09243096463004], [120.67666080962475, 24.092368991707144], [120.67658969028611, 24.092295214378908], [120.67648624397536, 24.092194877144351], [120.67647573770941, 24.092181597210349]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 4, "pid": 12 }, "geometry": { "type": "LineString", "coordinates": [[120.67647412136078, 24.092181597210363], [120.6763868385361, 24.092094539831209], [120.67623975081301, 24.091723438644806], [120.67609912848431, 24.09154563431785]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 5, "pid": 13 }, "geometry": { "type": "LineString", "coordinates": [[120.67609912848428, 24.091547847649185], [120.67591486474325, 24.09136487862467], [120.67569665768148, 24.091158300379778], [120.67556573344446, 24.091026975465219], [120.67524569642056, 24.090727436111568]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 6, "pid": 14 }, "geometry": { "type": "LineString", "coordinates": [[120.67524408007196, 24.090728911676592], [120.67509699234886, 24.090584306222453], [120.67487393624128, 24.090382153426294], [120.67472523216958, 24.090258205568759], [120.67456683000624, 24.090125404159775]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 7, "pid": 15 }, "geometry": { "type": "LineString", "coordinates": [[120.67456602183192, 24.090123190801798], [120.67448843709889, 24.090058265617309], [120.67432518588971, 24.089922512852535], [120.67419749434988, 24.089816271458051], [120.67403101044353, 24.089674616128402], [120.67395827475626, 24.089617068606003]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 8, "pid": 16 }, "geometry": { "type": "LineString", "coordinates": [[120.67395665840763, 24.089619281972723], [120.67392271508692, 24.089591245991404], [120.67378047640962, 24.089458443891235], [120.67361399250326, 24.089359580016193], [120.67357681648532, 24.089330068396912], [120.67345559033993, 24.089229728840564], [120.67332304975427, 24.088947892313495], [120.6730337233539, 24.08891690501353], [120.67298684924434, 24.088698518115621]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 9, "pid": 17 }, "geometry": { "type": "LineString", "coordinates": [[120.67298516349399, 24.088698498378232], [120.67272320994606, 24.088752440001134], [120.67254299378337, 24.088808179654265], [120.67240019955612, 24.08887380856963]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 10, "pid": 18 }, "geometry": { "type": "LineString", "coordinates": [[120.67240299087513, 24.088875166039351], [120.67231182952739, 24.088779029759646], [120.6721122176108, 24.088766115925541], [120.67195189937858, 24.088756071831448]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 11, "pid": 19 }, "geometry": { "type": "LineString", "coordinates": [[120.67195189937858, 24.088757506702066], [120.67159668447191, 24.088770420537049], [120.67121474985989, 24.088585322111342], [120.67118881602818, 24.088567386203103], [120.67108272308039, 24.088560929275594], [120.67070550371044, 24.08839591879433], [120.67061119886802, 24.088388744420911]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 12, "pid": 20 }, "geometry": { "type": "LineString", "coordinates": [[120.67061434236278, 24.088390179295498], [120.67045559587795, 24.088375830547317], [120.67027484492986, 24.088449009146274], [120.6701176701924, 24.088502099476205], [120.66990862779157, 24.088566668766781]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 13, "pid": 21 }, "geometry": { "type": "LineString", "coordinates": [[120.66990469842312, 24.088567386203163], [120.66976166941203, 24.088610432378562], [120.66960292292718, 24.088657783154783], [120.66953533779007, 24.088677871357611], [120.66947718313722, 24.08871661288271], [120.66940488275797, 24.088739570817996]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 14, "pid": 22 }, "geometry": { "type": "LineString", "coordinates": [[120.66940173926322, 24.088741005688803], [120.66929957568388, 24.088732396463648], [120.66919741210452, 24.088720917495888], [120.66911725298841, 24.088706568784726], [120.6689805109668, 24.088676436486065], [120.66880447526086, 24.08862191135621]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 15, "pid": 24 }, "geometry": { "type": "LineString", "coordinates": [[120.66879976001871, 24.088623346228342], [120.66874946410272, 24.088590344165162], [120.66868973770246, 24.088507121533311], [120.66862215256535, 24.088428203470411], [120.668557710923, 24.088320587851797], [120.66857185664938, 24.088283281082916], [120.668582858881, 24.088245974303167], [120.66862372431272, 24.088197188497887], [120.6687431771132, 24.088072354146878]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 16, "pid": 25 }, "geometry": { "type": "LineString", "coordinates": [[120.66874160536585, 24.088072354146878], [120.66881547749247, 24.087996305574595], [120.66888463437694, 24.087915952317104], [120.66892549980869, 24.087848512937118], [120.66894278902981, 24.08781120603081], [120.66896950873519, 24.087750941005371], [120.66901194591429, 24.087699285246739], [120.66905595484079, 24.087651934116355], [120.6690748158093, 24.087628975986245]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 17, "pid": 26 }, "geometry": { "type": "LineString", "coordinates": [[120.66907324406189, 24.087633280635945], [120.66917697938864, 24.08751848992754], [120.66925871025212, 24.087409438659304], [120.66939073703159, 24.087274559330769], [120.66954162477955, 24.087116721638402], [120.6696139251588, 24.087013409589058], [120.66970194301177, 24.086780957173549], [120.66979310435948, 24.086585811610302]] } },
                { "type": "Feature", "properties": { "name": "二給", "id": 18, "pid": 27 }, "geometry": { "type": "LineString", "coordinates": [[120.66978996086476, 24.086587246505232], [120.66985754600188, 24.086448061622054], [120.66991255715999, 24.086333269852094], [120.66992670288636, 24.086300267199203], [120.66994242036012, 24.086264394740766], [120.66994713560223, 24.086228522272279], [120.66995499433912, 24.086165386703392], [120.66997385530762, 24.086069248391009], [120.66998328579186, 24.086024766460874]] } },
                // { "type": "Feature", "properties": { "name": "四給", "id": 1, "pid": 28 }, "geometry": { "type": "LineString", "coordinates": [[120.66970671983663, 24.089174146940653], [120.66940730670544, 24.088811875974677]] } },
                // { "type": "Feature", "properties": { "name": "四給", "id": 2, "pid": 28 }, "geometry": { "type": "LineString", "coordinates": [[120.6694030089093, 24.088741252634588], [120.66940587410674, 24.088807952456811]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 3, "pid": 29 }, "geometry": { "type": "LineString", "coordinates": [] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 4, "pid": 30 }, "geometry": { "type": "LineString", "coordinates": [[120.66875305678042, 24.088678149339465], [120.66847513262992, 24.088666378773205], [120.66831181637657, 24.088607525925685], [120.66825594502673, 24.088568290679], [120.66814563492578, 24.08854736520917], [120.66781327202419, 24.088434890750388], [120.66741214438433, 24.088374729952832], [120.66733621665252, 24.088498975047134]] } },
                // { "type": "Feature", "properties": { "name": "四給", "id": 5, "pid": 31 }, "geometry": { "type": "LineString", "coordinates": [[120.66873407484739, 24.088704960069673], [120.6687519823313, 24.088677822379296]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 6, "pid": 32 }, "geometry": { "type": "LineString", "coordinates": [[120.66733636628403, 24.088499677904917], [120.66723593474248, 24.088460720649337], [120.66707834888398, 24.088477722605319], [120.66686918947175, 24.088438487318871], [120.66672306440297, 24.088438487318871], [120.66666719305313, 24.088494724559034], [120.66663567588144, 24.088531344144002], [120.66661418690072, 24.088564040193177], [120.6663147737696, 24.088527420617549]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 7, "pid": 33 }, "geometry": { "type": "LineString", "coordinates": [[120.66630904337471, 24.088530036301876], [120.66624314383387, 24.088523497090968], [120.66602538882941, 24.088448950063107], [120.66592653951815, 24.088433255946438], [120.66569732372396, 24.088387481428565], [120.66566437395355, 24.088384865741336], [120.66535063483524, 24.088361324553862]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 8, "pid": 34 }, "geometry": { "type": "LineString", "coordinates": [[120.66534633703913, 24.08836328631963], [120.66517585779219, 24.08836982553871], [120.66487930985845, 24.088394674568157], [120.66474607817807, 24.088412984376252], [120.66463576807712, 24.088335821595869]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 9, "pid": 35 }, "geometry": { "type": "LineString", "coordinates": [[120.66463290287965, 24.088343668660404], [120.66441801307261, 24.088239041093782], [120.66427761839864, 24.088137029134074], [120.66408565017102, 24.087930389274575], [120.66377620884886, 24.087634815225513], [120.66347822831638, 24.087446484502426], [120.66341805917041, 24.087485720092563], [120.66327766449645, 24.08765574084433], [120.66304844870227, 24.087838839863213], [120.6629481667923, 24.087906848003616], [120.6628736716592, 24.087854534052664]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 10, "pid": 36 }, "geometry": { "type": "LineString", "coordinates": [[120.66286794126435, 24.087854534052664], [120.66281636771066, 24.08780745147855], [120.66266451224701, 24.087878075333229], [120.66254703915247, 24.087880691030801], [120.66238945329395, 24.087535418489473]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 11, "pid": 37 }, "geometry": { "type": "LineString", "coordinates": [[120.66238945329395, 24.087532802784839], [120.66189090894159, 24.087595579681011], [120.66133219544322, 24.087679282161393]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 12, "pid": 38 }, "geometry": { "type": "LineString", "coordinates": [[120.66133506064062, 24.087679282161393], [120.66091960701364, 24.087718517680258]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 13, "pid": 39 }, "geometry": { "type": "LineString", "coordinates": [[120.66091101142139, 24.087718517680258], [120.66078494273457, 24.087726364782593], [120.66063881766578, 24.087744674686167], [120.6605070185841, 24.087765600287046], [120.6602863983822, 24.087799604381178], [120.66015746449796, 24.087823145671841], [120.65995690067805, 24.087844071259909], [120.65985661876807, 24.087851918354559], [120.65961594218416, 24.087893769517869], [120.65936667000798, 24.087935620667515], [120.65928930967745, 24.087953930541193], [120.65908015026523, 24.088006244451563]] } },
                { "type": "Feature", "properties": { "name": "四給", "id": 14, "pid": 40 }, "geometry": { "type": "LineString", "coordinates": [[120.65907441987036, 24.088008860146527], [120.658951216381, 24.088032401398742], [120.65860166229486, 24.088100409436425], [120.65825210820871, 24.088016707231084]] } },
            ]
        },
        ChanghuaGrid: {
            "type": "FeatureCollection",
            "crs": { "type": "name", "properties": { "name": "urn:ogc:def:crs:OGC:1.3:CRS84" } },
            "features": [
                { "type": "Feature", "properties": { "pid": 1 }, "geometry": { "type": "LineString", "coordinates": [[120.48777035698276, 24.082695732878967], [120.48771549832573, 24.082906083910672]] } },
                { "type": "Feature", "properties": { "pid": 2 }, "geometry": { "type": "LineString", "coordinates": [[120.4877118410819, 24.082914431166685], [120.48766795415629, 24.083078037275399], [120.48760212376787, 24.083303412695425]] } },
                { "type": "Feature", "properties": { "pid": 3 }, "geometry": { "type": "LineString", "coordinates": [[120.48759663790214, 24.083316768263444], [120.48747594885671, 24.083704079130424], [120.48732234461706, 24.084188216068469], [120.48717971210881, 24.084648979180184], [120.48704805133195, 24.085073013333954], [120.48691639055515, 24.085510401424386]] } },
                { "type": "Feature", "properties": { "pid": 4 }, "geometry": { "type": "LineString", "coordinates": [[120.48691273331137, 24.085517079093592], [120.48678472977832, 24.085927755080917]] } },
                { "type": "Feature", "properties": { "pid": 5 }, "geometry": { "type": "LineString", "coordinates": [[120.48678472977834, 24.085931093904694], [120.48664575451389, 24.086365140254554]] } },
                { "type": "Feature", "properties": { "pid": 6 }, "geometry": { "type": "LineString", "coordinates": [[120.48664209727008, 24.086371817879225], [120.48651409373704, 24.086799185134495]] } },
                { "type": "Feature", "properties": { "pid": 7 }, "geometry": { "type": "LineString", "coordinates": [[120.48650677924947, 24.086805862736565], [120.48641900539825, 24.087092999295859], [120.48620688525774, 24.087774111352086], [120.48602676601296, 24.088357143721755]] } },
                { "type": "Feature", "properties": { "pid": 8 }, "geometry": { "type": "LineString", "coordinates": [[120.48602585168956, 24.088358395770705], [120.48596367854496, 24.088562059999102], [120.48593259197263, 24.088665561368188]] } },
                { "type": "Feature", "properties": { "pid": 9 }, "geometry": { "type": "LineString", "coordinates": [[120.48592939188435, 24.088675160281269], [120.48589830531203, 24.088723572179649], [120.48585076114263, 24.088785339057928], [120.48577395902279, 24.088872146512212], [120.48561121167363, 24.08898232511952], [120.48550515160338, 24.089062454956252], [120.48539360566744, 24.089147592852875], [120.48533326114475, 24.089192665834062]] } },
                { "type": "Feature", "properties": { "pid": 10 }, "geometry": { "type": "LineString", "coordinates": [[120.48532777527905, 24.089197673942124], [120.48511382651665, 24.089352925194376], [120.48487793429146, 24.089529878005248], [120.4847225014299, 24.089641725410598], [120.48439883535353, 24.089885452254272], [120.48433117634319, 24.089935533055161], [120.48420134418826, 24.090020670371747], [120.48414282828743, 24.090042372031625], [120.48404408270477, 24.090034025239792], [120.48371858800648, 24.089963912166962], [120.48330257652415, 24.089878774812693]] } },
                { "type": "Feature", "properties": { "pid": 11 }, "geometry": { "type": "LineString", "coordinates": [[120.48328977617079, 24.089879609492883], [120.4821121436668, 24.089639221365264], [120.48116857476607, 24.089458929973617], [120.4807297055099, 24.089358767979761], [120.48064376028049, 24.089343743673918]] } },
                { "type": "Feature", "properties": { "pid": 12 }, "geometry": { "type": "LineString", "coordinates": [[120.48064193165871, 24.089347082408736], [120.48026889279099, 24.089265283381536], [120.47997265604309, 24.089208524842196], [120.47940029738821, 24.089091668946786], [120.47928326558657, 24.089064959012873], [120.47924303590474, 24.089061620270737]] } },
                { "type": "Feature", "properties": { "pid": 13 }, "geometry": { "type": "LineString", "coordinates": [[120.47921743519817, 24.089054942786209], [120.47881513838001, 24.08896813545574], [120.47863959067755, 24.088928070514147], [120.47835432566109, 24.088928070514147], [120.47812026205779, 24.088934748005286], [120.4778423115289, 24.08894810298651]] } },
                { "type": "Feature", "properties": { "pid": 14 }, "geometry": { "type": "LineString", "coordinates": [[120.47783133979748, 24.088951441731602], [120.47729372495868, 24.088978151689183], [120.47731932566529, 24.089959738768574], [120.47731566842145, 24.090470561723123], [120.47731932566529, 24.090964689179494], [120.47732481153101, 24.091338622204209]] } },
                { "type": "Feature", "properties": { "pid": 15 }, "geometry": { "type": "LineString", "coordinates": [[120.47731566842154, 24.091361992982041], [120.47733029739673, 24.092223370104854]] } },
                { "type": "Feature", "properties": { "pid": 16 }, "geometry": { "type": "LineString", "coordinates": [[120.47732298290913, 24.092243402062071], [120.47734492637194, 24.093291736785691], [120.47734492637194, 24.093699049237195], [120.47735224085953, 24.094513670255608], [120.47735224085953, 24.09499442777053]] } },
                { "type": "Feature", "properties": { "pid": 17 }, "geometry": { "type": "LineString", "coordinates": [[120.47735224085956, 24.094999435651349], [120.47735955534719, 24.095802363419601]] } },
                { "type": "Feature", "properties": { "pid": 18 }, "geometry": { "type": "LineString", "coordinates": [[120.47735772672524, 24.095807371269316], [120.47737235570047, 24.096368249197507], [120.47737967018804, 24.096725473740772], [120.47738332743187, 24.096862353909263]] } },
                { "type": "Feature", "properties": { "pid": 19 }, "geometry": { "type": "LineString", "coordinates": [[120.47737601294426, 24.096885723679531], [120.47739795640706, 24.098000790619455], [120.47733212601867, 24.098141007930877], [120.47613255005183, 24.09897563160872], [120.47508630179718, 24.099693592941222]] } },
                { "type": "Feature", "properties": { "pid": 20 }, "geometry": { "type": "LineString", "coordinates": [[120.47508033615257, 24.099697182430752], [120.4747896991082, 24.099896979155481]] } },
                { "type": "Feature", "properties": { "pid": 21 }, "geometry": { "type": "LineString", "coordinates": [[120.47477534666159, 24.099910080569149], [120.47397878587333, 24.100453788055212], [120.47371326561057, 24.100637206927487], [120.47329704465817, 24.100931986707604], [120.47222061116051, 24.101678759114218]] } },
                { "type": "Feature", "properties": { "pid": 22 }, "geometry": { "type": "LineString", "coordinates": [[120.47220984682552, 24.10169186034565], [120.47120517556107, 24.102379673113465], [120.47037990987955, 24.102982325073853]] } },
                { "type": "Feature", "properties": { "pid": 23 }, "geometry": { "type": "LineString", "coordinates": [[120.47035838120961, 24.102995426171933], [120.46951876308147, 24.103578423679625], [120.4690738372358, 24.103598075234768], [120.46841362469058, 24.103657029882111], [120.46816963309776, 24.103676681425199]] } }
            ]
        }

    };


    //工廠Icon
    var FactoryIcon = getIcon('css/images/Factory.png');
    //自動測站Icon
    var AutoSiteIcon = getIcon('css/images/AutoSite.png');
    //河水堰Icon
    var WeirIcon = getIcon('css/images/weir.png');
    //樹酯包擺放Icon
    var ResinIcon = getIcon('css/images/Resin2.png');

    //面
    var Irrigation = L.geoJson(geoData.Irrigation, {
        style: {
            "color": "#ff7800",
            "weight": 2,
            "opacity": 0.4
        },
        onEachFeature: function (feature, layer) {
            layer.bindPopup("灌溉小組：" + feature.properties.GRP_CNS.toString());
        },
    });


    // 線
    var TaichungGrid = L.geoJson(geoData.TaichungGrid, {
        onEachFeature: function (feature, layer) {
            layer.bindPopup("網格編號：" + feature.properties.pid.toString());
            layer.pid = feature.properties.pid;
        },
        style: function (feature) {
            return {weight: 7};
        }
    })

    var ChanghuaGrid = L.geoJson(geoData.ChanghuaGrid, {
        onEachFeature: function (feature, layer) {
            layer.bindPopup("網格編號：" + feature.properties.pid.toString());
            layer.pid = feature.properties.pid;
        },
        style: function (feature) {
            return {weight: 7};
        }
    })


    //點
    // var SankuaicuoRiver = setGeoJson(geoData.SankuaicuoRiverWeir, WeirIcon);
    var AutoSite = setGeoJson(geoData.metal, AutoSiteIcon);
    // var Factory = setGeoJson(geoData.Factory, FactoryIcon);
    // var Resin = setGeoJson(geoData.Resin, ResinIcon);

    var overlayMaps = {
        // "隱患處": PotentialDanger,
        // "溪流": River,

        // "三塊厝支線河水堰": SankuaicuoRiver,
        
        // "廠商": Factory,
        // "樹酯包擺放": Resin
        "灌溉小組": Irrigation,
        "台中詹厝園圳": TaichungGrid,
        "彰化新圳": ChanghuaGrid,
        "自動測站": AutoSite,
    };

    var map = L.map('map', {
        layers : [streets, Irrigation, TaichungGrid, ChanghuaGrid, AutoSite]
    }).fitBounds([
            [24.07, 120.63],
            [24.1, 120.7]
        ]);

    map.fitBounds(TaichungGrid.getBounds().pad(0.2));

    // var SKCGroup = new L.LayerGroup();
    // var SankuaicuoGridPoint = [];
    // SankuaicuoGridPoint.forEach(function (item, index) {

    //     var circle = L.circle([item[1], item[0]], {
    //             color : 'black',
    //             weight : 2,
    //             fillOpacity : 0,
    //             radius : 50
    //         }); //.bindPopup((index + 1).toString())

    //     circle._index = index;

    //     circle.on("click", function (event) {

    //         SKCGroup.eachLayer(function(circle) {
    //             circle.setStyle({
    //                 color: 'black'
    //             });
    //         });

    //         this.setStyle({ color: 'red' });
    //         vm.site = circle._index;
    //         window.chart.draw(vm.site);

    //         var dx = (data[window.chart.focusIndex][vm.site][vm.type] / data.max[vm.type] * 100) * 3;
    //         d3.select("#colorBar rect").attr("transform", "translate(" + (dx + 23.5) + ", 8)");

    //     });

    //     circle.addTo(SKCGroup);
    // })

    // SKCGroup.addTo(map);

    L.control.layers(baseMaps, overlayMaps).addTo(map);



    //colorBar
    window.colorBarControl = L.Control.extend({
        options: {
            position: 'bottomleft'
        },

        onAdd: function(map) {

            var child = document.querySelector('.colorBar');

            var parent = document.querySelector('.leaflet-bottom.leaflet-left');
            // if (child !== null)
            //     parent.removeChild(child);

            var container = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom colorBar');

            container.style.backgroundColor = 'white';
            container.style.width = '350px';
            container.style.height = '70px';
            container.setAttribute('name', 'colorbar');

            var canvas = document.createElement("canvas");

            canvas.setAttribute('width', '350px');
            canvas.setAttribute('height', '70px');

            var context = canvas.getContext("2d");
            context.textAlign = "center";

            // var max = window.data.max[vm.type];
            var max = 300;
            var colmap = d3.scaleLinear().range(['#FFFF6F', '#006000']).domain([0, max]);

            for (var i = 0; i < 100; i++) {
                context.beginPath();
                context.rect(i * 3 + 25, 8, 3, 30);
                context.fillStyle = colmap(i * max / 100);
                //context.fillStyle = d3.interpolateViridis(i/100);
                context.fill();
                context.closePath();
                if (i % 20 == 0) {
                    context.fillStyle = '#000';
                    context.fillText((i * max / 100).toFixed(1), i * 3 + 25, 50);
                }
            }
            context.fillStyle = '#000';
            context.fillText(max.toFixed(1), 325, 50);

            context.fillText('水體銅濃度(ppb)', 280, 65);


            container.appendChild(canvas);

            return container;
        }
    });
    map.addControl(new window.colorBarControl());


    //綁定至window
    window.mapObj = new Vue({
        data: {
            map: map,
            TaichungGrid: TaichungGrid,
            ChanghuaGrid: ChanghuaGrid
        }
    })


    //取得Icon
    function getIcon(path) {
        return L.icon({
            iconUrl: path,
            iconSize: [32, 32],
            iconAnchor: [16, 16],
            popupAnchor: [0, -10]
        })
    };

    //設定GeoJson物件
    function setGeoJson(data, icon) {
        return L.geoJson(data, {
            pointToLayer: seticon(icon),
            onEachFeature: onEachFeature
        });
    };

    //設定Icon物件
    function seticon(icon) {
        return function(feature, latlng) {
            return L.marker(latlng, {
                icon: icon
            });
        }
    };

    //綁定POP事件
    function onEachFeature(feature, layer) {
        layer.bindPopup(feature.properties.Name);
        return
    };


})(window, document);